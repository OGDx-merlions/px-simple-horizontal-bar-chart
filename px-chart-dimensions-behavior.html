<script>
/*
    Name:
    pxChartDimensionsBehavior

    Description:
    pxChartDimensionsBehavior is a Polymer behavior for use in
    px-simple-bar-chart and px-simple-line-chart to define the width and height
    of the SVG chart drawn using the D3.js graphics library. It adds two
    attributes to an element: `width` and `height` attributes which may be
    defined as: Number, Number as String, or "auto". Numbers will be coerced
    into String and auto will set the element up to be responsive.

    Dependencies:
    This behavior depends on local method this._drawChart.

    Defaults:
    defaultWidth, defaultHeight
*/

var defaultWidth = '283';
var defaultHeight = '150';

var pxChartDimensionsBehavior = {

    properties: {
        /**
        * width
        *
        * Format: String
        */
        width: {
            type: String,
            observer: '_drawChart',
            value: defaultWidth
        },
        /**
        * height
        *
        * Format: String
        */
        height: {
            type: String,
            observer: '_drawChart',
            value: defaultHeight
        }
    },

    _reconcileWidth: function(value) {
        return this._reconcileDimensionValue(value, defaultWidth, 'width');
    },

    _reconcileHeight: function(value) {
        return this._reconcileDimensionValue(value, defaultHeight, 'height');
    },

    _reconcileDimensionValue: function(value, defaultValue, type) {
        var value = this._reconcileValue(value, defaultValue);
        return value === 'auto' ? this._getAutoValue(type) : value;
    },

    _getAutoValue: function(type) {
        var parent = this.parentNode;
        var padding = this._getElementPadding(parent);
        if(type === 'width') {
            return parseInt(parent.clientWidth - padding.left - padding.right);
        } else if(type === 'height') {
            return parseInt(parent.clientHeight - padding.top - padding.bottom);
        }
    },

    _getElementPadding: function(el) {
        var style = window.getComputedStyle(el, null);
        return {
            top: style.getPropertyValue('padding-top').split('px')[0],
            right: style.getPropertyValue('padding-right').split('px')[0],
            bottom: style.getPropertyValue('padding-bottom').split('px')[0],
            left: style.getPropertyValue('padding-left').split('px')[0]
        };
    }

};
</script>
